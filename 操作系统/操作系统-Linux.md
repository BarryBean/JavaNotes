# 1. 基础操作和概念
## 1.1 快捷键
- Tab：补全。
- Ctrl + C：中断。
- Ctrl + D：结束键盘输入。

## 1.2 关机
- who：查看当前在线用户；
- sync：同步操作，将内存文件同步磁盘；
- shutdown -h now：立即关机。 

## 1.3 路径
- 路径间用 ：分割；
- sudo：允许一般用户使用 root 命令。

## 1.4 包管理工具
- RPM：Red Hat => CentOS
- DPKG：Ubuntu => Debian

## 1.5 vim
分为三个模式。
- vim进入的默认模式是 一般指令模式Command mode，可以进行剪切粘贴，游标移动；
- i,I,a,A,o,O 进入编辑模式，esc退出；
- : 进入指令列模式，用于保存退出。

指令列模式的操作又有：
- :w：写入磁盘；
- :q：离开；
- :wq：写入磁盘后离开；
- 加上!就是强制操作。



# 2. 文件系统
Linux哲学：一切都是文件。
## 2.1 组成
答：主要包括：
- inode：一个文件占用一个inode，记录文件属性和文件内容的block编号。
- block：记录文件内容。
- superblock：记录文件系统的整体信息。包括inode、block的总量、使用量、剩余量等。
- block bitmap：记录block是否被使用的位图。

![Linux文件](DB5C1283488F47459E8855628D810E9A)


### 2.1.1 block
答：一个block只能被一个文件使用，未使用的部分就是被浪费了。可以理解为内存块。

Ext2文件系统支持1K、2K、4K三种大小，分别限制了单个文件和文件系统的大小。


### 2.1.2 inode
答：inode的特点有：
- 每个inode均是128bytes。
- 一个文件有且仅占用一个inode。
- inode内的block编号使用间接引用。让引用的block块记录block信息。

## 2.2 文件类型
![文件类型](9DB24F627A0546E092626DFC7BC33477)
## 2.3 文件读取
答：根据文件系统不同，读取方式也不同。
- Ext2：先读inode中内容所在的所有block，再读取block内容。
- FAT：没有inode，block存着下一个block的编号。


## 2.4 文件属性
答：
- 用户分为：文件所有者、所在群组、其他用户。
- 文件分为：d目录、-文件、|链接文件。
- 权限分为：r可读、w可写、x可执行。转为数字即421。
- 文件时间：内容更新、状态更新、读取更新。
- 文件的默认权限是 666，目录的默认权限是777。


## 2.5 目录结构
![Linux目录结构](E4386E1CA06E451BAF381F29C8839BE8)
- /root：根目录；
- /bin：存放二进制文件，存储着命令；
- /etc：存放系统管理和配置文件；
- /home：存放用户文件的根目录；
- /usr：默认存放系统应用程序；
- /var：存放运行过程中的产生的数据文件。

## 2.6 挂载目录日志
- 挂载：用目录作为文件系统的进入点，即进入该目录相当于进入系统能进行数据读取。
- 目录：分配一个inode和若干block，block记录目录下所有文件的inode编号和文件名。
- 日志：用来修复文件系统，回滚操作。

## 2.7 链接
1. 实体链接：在目录下创建一个条目，记录源文件inode编号和文件名。
2. 符号链接：保存源文件的绝对路径。理解为windows的快捷方式。

# 3.进程管理
## 3.1 进程状态
和os中的进程状态相似。
- R：正在执行或者可执行，位于执行队列中。
- D：不可中断阻塞，通常为 IO 阻塞。
- S：可中断阻塞，进程正在等待某个事件完成。
- Z：僵死，进程已经终止但是尚未被其父进程获取信息。
- T：结束。


## 3.2 SIGCHLD
答：当一个子进程改变状态，父进程会发生两件事。

- 得到SIGCHLD信号。包含子进程的信息，如ID、状态等。
- wait()调用销毁子进程并返回。父进程通过wait()获得退出子进程的信息。成功就返回子进程id，失败返回-1。


## 3.3 孤儿进程
答：父进程退出，但子进程还在运行，这些子进程就是孤儿进程。孤儿进程会被 init 进程收养和处理。

## 3.4 僵尸进程
答：子进程退出后，父进程没有调用wait()释放进程描述符，使得子进程描述符一直保存在系统中，这就是僵尸进程。
- 危害：进程号是有限的，僵尸进程占据大量进程号。
- 解决方法：杀死父进程，让僵尸进程变成孤儿进程。



# 4.常用命令
## 4.1 文件和目录命令
1. cd

```
cd xxx：切换到该目录下的xxx目录；
cd ..：切换到上一层目录；
cd /：切换到根目录；
cd ~：切换到用户主目录；
cd -：切换到上一个操作所在的目录。
```


2. ls 列出文件或目录信息。通常用 ll
3. mkdir 创建目录。
4. rmdir 删除目录，必须为空。
5. touch 建立文件/更新文件时间。
6. cp 复制文件

```
cp -r source destination
```

7. rm 删除文件

```
rm -rf：删库跑路
```

8. mv 移动文件
```
mv -f source destination 强制移动
```


## 4.2 修改权限
chmod [ugoa] [+-=] [rwx]
```
chmod u=rwx,g=rw,o=r aaa.txt
chmod 764 aaa.txt
chmod a+w .bashrc
```
修改aaa.txt的权限为：用户拥有全部权限，用户组有读写权限，其他用户只有读权限。也可以用数字表示。

## 4.3 获取文件内容
- cat：取得文件内容；
- tac：cat的反向操作，从最后一行获取文件内容；
- more：一页一页查看文件内容，q退出，回车下一行，空格下一页；
- less：PgUp和PgDn翻页；
- head -x：查看前x行；
- tail -x：查看后x行，Ctrl+C结束；

## 4.4 压缩命令
1. 压缩指令
压缩指令只对单个文件进行压缩。
- gzip 使用最多
```
gzip [-cdtv#] filename
 -c：将压缩数据输出到屏幕；
 -d：压缩；
 -t：校验压缩文件；
 -v：显示压缩比信息；
 -#：压缩等级，默认6，越大越高。
```
- bzip2 更高的压缩比
- xz 更加高的压缩比

2. 打包
打包能将多个文件打包成一个大文件，且将打包和压缩合在一起进行。

```
//打包压缩
tar [-z|-j|-J] [cv] -f filename
 -z：使用gzip；
 -j：使用bzip2；
 -J：使用xz；
 -c：新建打包文件；
 -v：在过程中，显示处理的文件名；
 -f：要处理的文件；
 
//查看
tar [-z|-j|-J] [tv] -f filename
 -t：查看打包文件中的内容；

//解压缩
tar [-z|-j|-J] [xv] -f filename -C
 -x：解压缩；
 -C：在目标目录解压缩。
```

## 4.5 指令搜索和文件搜索
1. which -a 指令搜索
2. whereis filename 文件搜索
3. locate keyword 根据关键字或正则表达式搜索文件
4. find 根据属性和权限进行文件搜索

## 4.6 管道指令
1. 管道是将一个命令的输出作为另一个命令的输入。使用 | 作为分隔。
2. cut 切分数据，取出想要的部分。
```
last | cut -d ' ' -f 1 -c 12-
 -d：分隔符；
 -f：分隔后，使用 -f n 取出第 n 个区间；
 -c：以字符为单位取区间。-c 12- 取出第12字符后的字符串。
```
3. sort 排序
```
 -f ：忽略大小写
 -b ：忽略最前面的空格
 -M ：以月份的名字来排序，例如 JAN，DEC
 -n ：使用数字
 -r ：反向排序
 -u ：相当于 unique，重复的内容只出现一次
 -t ：分隔符，默认为 tab
 -k ：指定排序的区间
```
4. 字符转化指令
    - tr 删除行中字符 / 替换字符
    - join 合并有相同数据的行
    - paste 直接粘贴两行
5. split 将一个文件划分为多个文件
```
split [-bl] file PREFIX
-b ：以大小来进行分区，可加单位，例如 b, k, m 等；
-l ：以行数来进行分区；
-PREFIX ：分区文件的前缀名称。
```

## 4.7 正则表达式
1. grep 全局查找
```
grep [-acinv] [--color=auto] 搜寻字符串 filename
 -c ： 统计匹配到行的个数
 -i ： 忽略大小写
 -n ： 输出行号
 -v ： 反向选择，也就是显示出没有 搜寻字符串 内容的那一行
 --color=auto ：找到的关键字加颜色显示
```
2. printf 格式化输出，传数据时用 $()，不属于管道命令。
3. awk 逐行读文件，进行切片，对每部分进行分析处理。
```
awk '{pattern + action}' {filenames}
```

## 4.8 进程管理
1. ps 查看进程信息
```
 -l：查看自己进程
 aux：查看系统所有进程
```
2. pstree 查看进程树
3. top 实时显示进程信息
4. netstat 查看占用端口的进程
